<img width="253" height="32" alt="image" src="https://github.com/user-attachments/assets/ce4b1d68-f89e-484c-8390-3bb5ba9e9bfd" /># Справочник по FreeRTOS

## Содержание

## Полезные ссылки

[Сайт FreeRTOS](https://www.freertos.org/)

[Мануал CMSIS FreeRTOS](https://www.st.com/resource/en/user_manual/um1722-developing-applications-on-stm32cube-with-rtos-stmicroelectronics.pdf)

## Введение

FreeRTOS - это открытая (open-source) операционная система реального времени (RTOS) для микроконтроллеров и встраиваемых систем. Она обеспечивает многозадачность, управление потоками, планирование задач и синхронизацию в ограниченных по ресурсам устройствах.

FreeRTOS абсолютно бесплатна (лицензия MIT) даже для коммерческих приложений. Использование FreeRTOS не накладывает обязательство по открытию исходного кода, не накладывается обязательство по изменению ядра ОС.

Преимущества FreeRTOS:

- Легкая и быстрая - FreeRTOS занимает 0,5 КБ оперативной памяти и от 5 до 10 КБ ПЗУ
- Простая ахитектура
- Портируемость
- Открытый исходный код

## Структура FreeRTOS

FreeRTOS настраивается при помощи единственного файла - FreeRTOSConfig.h - он содержит все константы и макросы для конфигурации проекта

## FreeRTOS + stm32 + CubeIDE

Для работы с FreeRTOS на STM32 удобно использовать CubeIDE. Для того чтобы добавить FreeRTOS в проект необходимо включить его на вкладке Middleware -> FreeRTOS после чего выбрать версию CMSIS_V1 или CMSIS_V2.

<img width="626" height="158" alt="image" src="https://github.com/user-attachments/assets/7c4c48d6-cf2d-4574-8176-e36c990baf65" />

CMSIS_RTOS - это обертка для чистого FreeRTOS - она разработана для легкого перехода с одного типа RTOS на другой для ARM-процессоров (Например с FreeRTOS на RTX)

Для работы с STM32 лучше использовать CMSIS_V2 - это более современная версия чем V1. В отличии от V1 управление временем происходит в тиках, а не мс, доступны расширенные типы объектов, идентификаторы обьектов - структуры, а не указатели как в V1. V2 предоставляет более чистый и унифицированный API.

В первую очередь необходимо настроить RTOS. Сделать это можно во вкладке config parameters. По сути этот раздел изменяет файл FreeRTOSConfig.h. Описание каждого параметра приведено в ниже

### Config parameters

#### USE_PREEMTION

`USE_PREEMTION` - Параметр который определяет тип многозадачности.

При значении `1 (enabled)` - включает режим вытесняющей многозадачности, приостанавливает выполнение низкоприоритетной задачи (сохраняет ее сотояние и стек) при появлении готовой к выполнению высокоприоритетной и переключается на нее. При значении `0 (disabled)` включает кооперативный режим. 

При использовании кооперативного режима задачи сами должны вызывать `vTaskYIELD` в вытесняющем режиме задачи переключаются между друг другом при помощи планировщика, в кооперативном режиме нужно управлять временм вручную, кооперативный режим может привести к блокировке CPU одной задачей, в вытесняющем режиме нужно работать над синхронизацией задач.

#### USE_TIME_SLICING

`USE_TIME_SLICING`

| Параметр | Принимаемые значение | описание |
| ------------- | ------------- | ------------- |
| `USE_PREEMTION`  | Вытесняющая многозадачность или корпоративная многозадачность | `1 (enabled)` - вытесняющая многозадачность `0 (disabled)` - кооперативная многозадачность|
| `USE_TIME_SLICING`  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
| ``  | Content Cell  | Content Cell |
